<%= simple_form_for [:admin,@page] do |f| %>
  <%= f.association:parent_page, :collection => @pages %>
  <%= f.input :template, :collection => @files %>
  <%= f.association :page_template %>
  <%= f.input :is_visible %>
  <%= f.input :label %>
  <%= f.input :name %>

  <ul class="accordion">
      <%= f.simple_fields_for :page_elements do |pe| %>
          <li>
            <div class="title">
              <h5>
                <%= pe.object.class.class_name %>
                <%= ": #{pe.object.name}" unless pe.object.name.blank? %>
              </h5>
            </div>
            <div class="content">
              <%= pe.input :position %>
                <%= case pe.object.class.to_s
                  when BigosApp::TextBlockElement.to_s
                    pe.simple_fields_for :text_block do |tb|
                      render partial: "bigos_app/admin/text_blocks/form", locals: {tb:tb}
                    end
                  when BigosApp::GalleryElement.to_s
                    pe.simple_fields_for :gallery do |g|
                      render partial: "bigos_app/admin/galleries/form", locals: {g:g}
                    end
                  when BigosApp::ProductElement.to_s
                    pe.simple_fields_for :product_category do |pc|
                      render partial: "bigos_app/admin/product_categories/form", locals: {pc:pc}
                    end
                end %>
            </div>
          </li>
      <% end %>
  </ul>

  <%= f.button :submit %>
<% end %>